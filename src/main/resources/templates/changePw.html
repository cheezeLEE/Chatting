<!DOCTYPE html>
<html xmlns:th="http://www.w3.org/1999/xhtml">
<head>
   <meta charset="UTF-8">
   <meta http-equiv="X-UA-Compatible" content="IE=edge">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
   <title>비밀번호 찾기</title>

   <style>
      body{
         width: 480px;
         height: 280px;
         margin: 10px;
      }

      button{
         margin-left: 10px;
      }

      .row{
         margin-top: 10px;
      }
   </style>
</head>
<body>
   <h3>비밀번호 찾기</h3>
   <div th:if="${pwchange} == success">
     <script>window.close();</script>
   </div>
   <div th:unless="${pwchange} == success">
	   <p th:if="${count} != 1">
	     <script>
	       alert("일치하는 사용자가 없습니다.");
	       history.back();
	     </script>
	   </p>    
   </div>
	<input type="hidden" id="change" th:value="${pwChange}">
   <form id="changePwForm" th:action="@{/changePw}" method="POST">
       <input type="hidden" name="userId" th:value="${userId}"/>
      <div class="row">
         <label for="userPw" class="col-4">새 비밀번호</label>
         <input type="password" name ="userPw" class="col-7" id ="userPw" placeholder="비밀번호를 입력하세요">   
      </div>
      <div class="row">
         <label for="pwCheck" class="col-4">비밀번호 확인</label>
         <input type="password" name ="pwCheck" class="col-7" id ="pwCheck" placeholder="한 번더 입력하세요">
      </div>
      <div class="row">
         <div class="col-8"></div>
         <button id="uptBtn" class="btn btn-primary">변경</button>
         <button id="cancelBtn" class="btn btn-danger">취소</button>
      </div>
   </form>

   <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
   <script>
      $(function(){
    	 if($("#change").val() == "success"){
    		 window.close();
    	 }
    	 
         $("#uptBtn").on("click", function(e){
            e.preventDefault();
            if($("#userPw").val() != $("#pwCheck").val()){
            	alert("비밀번호가 일치하지 않습니다.");
            	return false;
            } else{
                $("#changePwForm").submit();
            }
         });
         
         $("#cancelBtn").on("click", function(e){
            e.preventDefault();
            window.close();
         });
      });
   </script>
</body>
</html>